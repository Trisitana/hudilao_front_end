import{d as ie,r as n,j as ne,c as re,B as se,a as x,o as B,b as P,e as a,w as s,g as p,f as Q,m as de,C as ce,H as k,L as m,p as ue,l as pe,_ as fe}from"./index-077565e4.js";import{d as ve,e as he,f as me,g as ye,h as be,i as ge,j as _e}from"./adminapi-369833a9.js";import"./manage-1ae7ae30.js";const y=F=>(ue("data-v-c609e6f1"),F=F(),pe(),F),we={id:"card-header"},xe={key:0,id:"card-header-text"},ke={key:1,id:"card-header-text"},Te=y(()=>p("div",{id:"main1",style:{width:"18vw",height:"45vh"}},null,-1)),Fe=y(()=>p("div",{id:"main2",style:{width:"22vw",height:"40vh"}},null,-1)),Ce={id:"card-header"},Le=y(()=>p("span",{id:"card-header-text"},"本周菜品热度Top5",-1)),Se=y(()=>p("div",{id:"main3",style:{width:"35vw",height:"25vh"}},null,-1)),De={id:"card-header"},Ae=y(()=>p("span",{id:"card-header-text"},"营业额数据报表",-1)),Be=y(()=>p("div",{id:"main4",style:{width:"36vw",height:"28vh"}},null,-1)),Pe={id:"card-header"},Me=y(()=>p("span",{id:"card-header-text"},"紧缺菜品",-1)),Ve=y(()=>p("div",{id:"card-header"},[p("span",{id:"card-header-text"},"一周各时段订单量热力图")],-1)),Ge=y(()=>p("div",{id:"main5",style:{width:"50vw",height:"40vh"}},null,-1)),Re=ie({__name:"DataReport",setup(F){let M=n([]);const i=ne({isThisMonth:!0,select:"",selectDate:"1",selectType:"0"}),X=()=>{console.log(i.isThisMonth),i.isThisMonth?(T.value=V.value,i.isThisMonth=!1,S()):(T.value=L.value,i.isThisMonth=!0,S())},C=()=>{console.log(i.selectDate),i.selectDate=="1"&&Y(),i.selectDate=="2"&&te(),i.selectDate=="3"&&ae()};let Z=re(()=>M.value.filter(e=>{if(i.selectType==="0")return!0;if(e.foodtype.toString()==i.selectType)return e.foodtype.toString()==i.selectType}));const f=()=>{i.select=="1"&&(r.value=D.value,c()),i.select=="2"&&(r.value=G.value,c()),i.select=="3"&&(r.value=R.value,c()),i.select=="4"&&(r.value=I.value,c()),i.select=="5"&&(r.value=z.value,c()),i.select=="6"&&(r.value=E.value,c()),i.select=="7"&&(r.value=H.value,c()),i.select=="8"&&(r.value=O.value,c()),i.select=="9"&&(r.value=N.value,c()),i.select=="10"&&(r.value=W.value,c()),i.select=="11"&&(r.value=U.value,c()),i.select=="12"&&(r.value=j.value,c()),i.select=="13"&&(r.value=$.value,c())};let L=n([]),V=n([]),T=n([]);const S=()=>{console.log(T.value);const t=k(document.getElementById("main1")),e={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{data:["一星级","二星级","三星级","四星级","五星级"],axisLabel:{inside:!0,color:"#fff"},axisTick:{alignWithLabel:!0},axisLine:{show:!1},z:10},yAxis:{axisLine:{show:!1},axisTick:{show:!0},axisLabel:{color:"#999"},splitLine:{show:!1}},series:[{name:"会员数",data:T.value.map(o=>o.countPerRank),type:"bar",showBackground:!0,itemStyle:{opacity:1,color:new m(0,0,0,1,[{offset:0,color:"rgb(0, 221, 255)"},{offset:1,color:"rgb(55, 102, 255)"}])}}]};t.setOption(e)},ee=()=>{console.log(b.value.map(o=>o.countPerRank)[0]);const t=k(document.getElementById("main2")),e={title:{text:"全部会员分布",x:"right",y:"top",textAlign:"center"},tooltip:{trigger:"item"},toolbox:{show:!0,feature:{mark:{show:!0}}},series:[{name:"会员分布",type:"pie",radius:[20,120],center:["50%","50%"],label:{normal:{color:"#FFFFFF",show:!0,position:"inner",formatter:"{d}%"}},roseType:"area",itemStyle:{borderRadius:8},data:[{value:b.value.map(o=>o.countPerRank)[0],name:"一星级",itemStyle:{opacity:.8,color:new m(0,0,0,1,[{offset:0,color:"rgb(128, 255, 165)"},{offset:1,color:"rgb(1, 191, 236)"}])}},{value:b.value.map(o=>o.countPerRank)[1],name:"二星级",itemStyle:{opacity:.8,color:new m(0,0,0,1,[{offset:0,color:"rgb(0, 221, 255)"},{offset:1,color:"rgb(77, 119, 255)"}])}},{value:b.value.map(o=>o.countPerRank)[2],name:"三星级",itemStyle:{opacity:.8,color:new m(0,0,0,1,[{offset:0,color:"rgb(55, 162, 255)"},{offset:1,color:"rgb(116, 21, 219)"}])}},{value:b.value.map(o=>o.countPerRank)[3],name:"四星级",itemStyle:{opacity:.8,color:new m(0,0,0,1,[{offset:0,color:"rgb(255, 0, 135)"},{offset:1,color:"rgb(135, 0, 157)"}])}},{value:b.value.map(o=>o.countPerRank)[4],name:"五星级",itemStyle:{opacity:.8,color:new m(0,0,0,1,[{offset:0,color:"rgb(255, 191, 0)"},{offset:1,color:"rgb(224, 62, 76)"}])}}]}]};t.setOption(e)};let D=n([]),G=n([]),R=n([]),I=n([]),z=n([]),E=n([]),H=n([]),O=n([]),N=n([]),W=n([]),U=n([]),j=n([]),$=n([]),r=n([]);const c=()=>{const t=k(document.getElementById("main3")),e={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{data:[r.value.map(o=>o.name)[0],r.value.map(o=>o.name)[1],r.value.map(o=>o.name)[2],r.value.map(o=>o.name)[3],r.value.map(o=>o.name)[4]],axisLabel:{inside:!0,color:"white",verticalAlign:"bottom",formatter:function(o){var v="",l=5,g=o.length,h=Math.ceil(g/l);if(h>1){for(var _=0;_<h;_++){var u="",d=_*l,w=d+l;_==h-1?(u=o.substring(d,w),v+=u):(u=o.substring(d,w)+`
`,v+=u)}return v}else return o}},axisTick:{alignWithLabel:!0},axisLine:{show:!1},z:10},yAxis:{axisLine:{show:!1},axisTick:{show:!0},axisLabel:{color:"#999"},splitLine:{show:!1}},series:{name:"周销售量",data:r.value.map(o=>o.monthsale),type:"bar",showBackground:!0,datasetIndex:1,itemStyle:{opacity:1,color:new m(0,0,0,1,[{offset:0,color:"rgb(0, 221, 255)"},{offset:1,color:"rgb(55, 102, 255)"}])}}};t.setOption(e)},Y=()=>{const t=k(document.getElementById("main4")),e={color:["#80FFA5","#00DDFF","#37A2FF","#FF0087","#FFBF00"],title:{},tooltip:{trigger:"axis",axisPointer:{label:{backgroundColor:"#6a7985"}}},legend:{data:["当日营业额"]},toolbox:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:["周一","周二","周三","周四","周五","周六","周日"]}],yAxis:[{type:"value"}],series:[{name:"当日营业额",type:"line",symbol:"circle",symbolSize:15,stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:new m(0,0,0,1,[{offset:0,color:"rgb(128, 255, 165)"},{offset:1,color:"rgb(1, 191, 236)"}])},emphasis:{focus:"series"},data:q.value.map(o=>o.totalMoney)}]};t.setOption(e)},te=()=>{const t=k(document.getElementById("main4")),e={color:["#00DDFF","#80FFA5","#37A2FF","#FF0087","#FFBF00"],title:{},tooltip:{trigger:"axis",axisPointer:{label:{backgroundColor:"#6a7985"}}},legend:{data:["当周营业额"]},toolbox:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:["一周","二周","三周","四周"]}],yAxis:[{type:"value"}],series:[{name:"当周营业额",type:"line",symbol:"circle",symbolSize:15,stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.8,color:new m(0,0,0,1,[{offset:0,color:"rgb(55, 162, 255)"},{offset:1,color:"rgb(116, 21, 219)"}])},emphasis:{focus:"series"},data:J.value.map(o=>o.totalMoney)}]};t.setOption(e)},ae=()=>{const t=k(document.getElementById("main4")),e={color:["#00DDFF","#80FFA5","#37A2FF","#FF0087","#FFBF00"],title:{},tooltip:{trigger:"axis",axisPointer:{label:{backgroundColor:"#6a7985"}}},legend:{data:["当月营业额"]},toolbox:{},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:A.value.map(o=>o.monthNumber+"月")}],yAxis:[{type:"value"}],series:[{name:"当月营业额",type:"line",symbol:"circle",symbolSize:15,stack:"Total",smooth:!0,lineStyle:{width:0},showSymbol:!1,areaStyle:{opacity:.7,color:new m(0,0,0,1,[{offset:0,color:"rgb(255, 191, 0)"},{offset:1,color:"rgb(224, 62, 76)"}])},emphasis:{focus:"series"},data:A.value.map(o=>o.totalMoney)}]};t.setOption(e)},oe=()=>{const t=k(document.getElementById("main5")),e=["0点","1点","2点","3点","4点","5点","6点","7点","8点","9点","10点","11点","12点","13点","14点","15点","16点","17点","18点","19点","20点","21点","22点","23点"],o=["周日","周一","周二","周三","周四","周五","周六"],v=K.value.map(u=>le(u)),l=[],g=[],h=[];o.forEach(function(u,d){l.push({textBaseline:"middle",top:(d+.5)*100/7+"%",text:u}),g.push({left:150,type:"category",boundaryGap:!1,data:e,top:d*100/7+5+"%",height:100/7-10+"%",axisLabel:{interval:2}}),h.push({singleAxisIndex:d,coordinateSystem:"singleAxis",type:"scatter",data:[],symbolSize:function(w){return w[1]*4},tooltip:{formatter:function(w){return`${w.data[0]}点 热度：${w.data[1]} `}}})}),v.forEach(function(u){h[u[0]].data.push([u[1],u[2]])});const _={tooltip:{position:"top"},title:l,singleAxis:g,series:h};t.setOption(_)};function le(t){let e=Array(3);return e[0]=t.dayOfWeek,e[1]=t.orderHour,e[2]=t.orderCount*2,e}let q=n([]),J=n([]),A=n([]);n([{rank:1,value:100},{rank:2,value:200},{rank:3,value:300},{rank:4,value:400},{rank:5,value:500}]);let b=n([]),K=n([]);return se(()=>{ve().then(t=>{q.value=t.data.data,Y()}),he().then(t=>{J.value=t.data.data}),me().then(t=>{A.value=t.data.data}),ye().then(t=>{L.value=t.data.data.list1,V.value=t.data.data.list2,b.value=t.data.data.list3,console.log(b.value.map(e=>e.countPerRank)[0]),T.value=L.value,S(),ee()}),be().then(t=>{D.value=t.data.data.filter(e=>{if(e.foodtype==1)return!0}),G.value=t.data.data.filter(e=>{if(e.foodtype==2)return!0}),R.value=t.data.data.filter(e=>{if(e.foodtype==3)return!0}),I.value=t.data.data.filter(e=>{if(e.foodtype==4)return!0}),z.value=t.data.data.filter(e=>{if(e.foodtype==5)return!0}),E.value=t.data.data.filter(e=>{if(e.foodtype==6)return!0}),H.value=t.data.data.filter(e=>{if(e.foodtype==7)return!0}),O.value=t.data.data.filter(e=>{if(e.foodtype==8)return!0}),N.value=t.data.data.filter(e=>{if(e.foodtype==9)return!0}),W.value=t.data.data.filter(e=>{if(e.foodtype==10)return!0}),U.value=t.data.data.filter(e=>{if(e.foodtype==11)return!0}),j.value=t.data.data.filter(e=>{if(e.foodtype==12)return!0}),$.value=t.data.data.filter(e=>{if(e.foodtype==13)return!0}),r.value=D.value,c()}),ge().then(t=>{M.value=t.data.data}),_e().then(t=>{K.value=t.data.data,console.log(t.data.data),oe()})}),(t,e)=>{const o=x("el-button"),v=x("el-card"),l=x("el-option"),g=x("el-select"),h=x("el-table-column"),_=x("el-tag"),u=x("el-table");return B(),P("div",null,[a(v,{id:"card-会员统计",shadow:"hover"},{header:s(()=>[p("div",we,[i.isThisMonth?(B(),P("span",xe,"本月新注册会员统计")):(B(),P("span",ke,"上月新注册会员统计")),a(o,{id:"button",text:"",bg:"",type:"primary",size:"small",onClick:X},{default:s(()=>[Q("切换")]),_:1})])]),default:s(()=>[Te,Fe]),_:1}),a(v,{id:"card-菜品售卖情况",shadow:"hover"},{header:s(()=>[p("div",Ce,[Le,a(g,{modelValue:i.select,"onUpdate:modelValue":e[0]||(e[0]=d=>i.select=d),placeholder:"菜品类别",style:{width:"100px"},size:"small"},{default:s(()=>[a(l,{onClick:f,label:"锅底",value:"1"}),a(l,{onClick:f,label:"特色菜",value:"2"}),a(l,{onClick:f,label:"牛羊肉",value:"3"}),a(l,{onClick:f,label:"海鲜",value:"4"}),a(l,{onClick:f,label:"丸滑",value:"5"}),a(l,{onClick:f,label:"其他荤菜",value:"6"}),a(l,{onClick:f,label:"豆面制品",value:"7"}),a(l,{onClick:f,label:"菌菇",value:"8"}),a(l,{onClick:f,label:"蔬菜",value:"9"}),a(l,{onClick:f,label:"饮料酒水",value:"10"}),a(l,{onClick:f,label:"甜品",value:"11"}),a(l,{onClick:f,label:"主食",value:"12"}),a(l,{onClick:f,label:"自选类",value:"13"})]),_:1},8,["modelValue"])])]),default:s(()=>[Se]),_:1}),a(v,{id:"card-周月年营业额",shadow:"hover"},{header:s(()=>[p("div",De,[Ae,a(g,{modelValue:i.selectDate,"onUpdate:modelValue":e[1]||(e[1]=d=>i.selectDate=d),placeholder:"选择",style:{width:"100px"},size:"small"},{default:s(()=>[a(l,{onClick:C,label:"本周",value:"1"}),a(l,{onClick:C,label:"月度",value:"2"}),a(l,{onClick:C,label:"年度",value:"3"})]),_:1},8,["modelValue"])])]),default:s(()=>[Be]),_:1}),a(v,{id:"card-紧缺菜品",shadow:"hover"},{header:s(()=>[p("div",Pe,[Me,a(g,{modelValue:i.selectType,"onUpdate:modelValue":e[2]||(e[2]=d=>i.selectType=d),placeholder:"菜品类别",style:{width:"100px"},size:"small"},{default:s(()=>[a(l,{label:"全部类别",value:"0"}),a(l,{label:"锅底",value:"1"}),a(l,{label:"特色菜",value:"2"}),a(l,{label:"牛羊肉",value:"3"}),a(l,{label:"海鲜",value:"4"}),a(l,{label:"丸滑",value:"5"}),a(l,{label:"其他荤菜",value:"6"}),a(l,{label:"豆面制品",value:"7"}),a(l,{label:"菌菇",value:"8"}),a(l,{label:"蔬菜",value:"9"}),a(l,{label:"饮料酒水",value:"10"}),a(l,{label:"甜品",value:"11"}),a(l,{label:"主食",value:"12"}),a(l,{label:"自选类",value:"13"})]),_:1},8,["modelValue"])]),a(u,{data:de(Z),height:"200",style:{width:"100%"}},{default:s(()=>[a(h,{prop:"name",label:"菜品名",width:"70"}),a(h,{prop:"foodtype",label:"类别",width:"75"}),a(h,{prop:"repository",label:"库存"},{default:s(d=>[a(_,{type:"danger"},{default:s(()=>[Q(ce(d.row.repository),1)]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1}),a(v,{id:"card-时段热力图",shadow:"hover"},{header:s(()=>[Ve]),default:s(()=>[Ge]),_:1})])}}});const He=fe(Re,[["__scopeId","data-v-c609e6f1"]]);export{He as default};
