import{d as K,u as L,i as O,r as C,j as z,c as D,B as Q,a as h,o as i,b,g as I,e as l,w as n,f as m,D as p,C as f,G as w,m as S,F as W,I as a,k as U,_ as X}from"./index-077565e4.js";import{r as Y,s as Z,t as ee,u as te}from"./adminapi-369833a9.js";import"./manage-1ae7ae30.js";const ae={class:"表格"},le={key:1,class:"bigger"},ne={key:1,class:"bigger"},se={key:1,width:"120",class:"bigger"},ie={class:"bigger"},oe={key:1,class:"bigger"},de={key:0},ue={key:1},re=K({__name:"EmployeeManage",setup(pe){L(),O(),C(!1);const v=C(1),g=C(12),u=z({dialogVisible:!1,modifyIndex:-1,inputSearch:""});let x="";function R(e){console.log("开始判断");let r=/^1[3-9][0-9]{9}$/;e.phonenumber.length==11&&r.test(e.phonenumber)?(x="正确",console.log(x)):(x="错误",console.log(x))}const A=e=>{if(e==0)return"男";if(e==1)return"女"};function T(e){if(e==1)return"服务员";if(e==2)return"厨师"}const s=z({id:"",name:"",sex:"",type:"",phonenumber:"",registertime:"",number:"",password:"",isEdit:!0,isAdd:!0}),$=()=>{console.log(v.value,k.value,g.value,Math.floor(k.value/g.value)),v.value=Math.floor(k.value/g.value)+1,y.value.push({id:"",name:"",sex:"",type:"",phonenumber:"",registertime:"",number:"",password:"",isEdit:!0,isAdd:!0})},B=e=>{a(e,"isEdit",!0),s.id=e.id,s.name=e.name,s.sex=e.sex,s.type=e.type,s.phonenumber=e.phonenumber,s.registertime=e.registertime,s.number=e.number,s.password=e.password,s.isEdit=e.isEdit,s.isAdd=e.isAdd},N=(e,r)=>{let c=e+(v.value-1)*g.value;Z({id:r.id}).then(d=>{U({type:"success",message:"删除成功！"})}),y.value.splice(c,1)},F=e=>{a(e,"id",e.id),a(e,"name",e.name),a(e,"sex",e.sex),a(e,"type",e.type),a(e,"phonenumber",e.phonenumber),a(e,"registertime",e.registertime),a(e,"number",e.number),a(e,"password",e.password),a(e,"isEdit",!1),a(e,"isAdd",!1),e.id==""?ee({number:e.number,name:e.name,sex:e.sex,type:e.type,phonenumber:e.phonenumber,password:e.password}).then(r=>{U({type:"success",message:"添加成功！"})}):e.id!=""&&(console.log("成功"),console.log({id:e.id,type:e.type,password:e.password,phonenumber:e.phonenumber}),te({id:e.id,type:e.type,password:e.password,phonenumber:e.phonenumber}).then(()=>{U({type:"info",message:"编辑成功！"})}))},G=e=>{a(e,"id",s.id),a(e,"name",s.name),a(e,"sex",s.sex),a(e,"type",s.type),a(e,"phonenumber",s.phonenumber),a(e,"registertime",s.registertime),a(e,"number",s.number),a(e,"password",s.password),a(e,"isEdit",!1),a(e,"isAdd",!1),console.log(e),e.id==""&&y.value.splice(y.value.length-1,1),U({type:"info",message:"取消编辑！"})},P=e=>{v.value=e};let k=D(()=>y.value.length),j=D(()=>{const e=(v.value-1)*g.value,r=e+g.value;return y.value.filter(d=>{if(u.inputSearch==="")return!0;if(d.number.includes(u.inputSearch))return d.number.includes(u.inputSearch);if(d.registertime.includes(u.inputSearch))return d.registertime.includes(u.inputSearch);if(A(d.sex).includes(u.inputSearch))return A(d.sex).includes(u.inputSearch);if(d.name.includes(u.inputSearch))return d.name.includes(u.inputSearch)}).slice(e,r)});const q=(e,r)=>r.type==e;Q(()=>{Y().then(e=>{y.value=e.data.data})});let y=C([]);return(e,r)=>{const c=h("el-input"),d=h("el-button"),_=h("el-table-column"),V=h("el-option"),M=h("el-select"),E=h("el-tag"),H=h("el-table"),J=h("el-pagination");return i(),b(W,null,[I("div",null,[l(c,{modelValue:u.inputSearch,"onUpdate:modelValue":r[0]||(r[0]=t=>u.inputSearch=t),placeholder:"搜索关键字",class:"inputSearch"},null,8,["modelValue"]),l(d,{round:"",type:"primary",onClick:$,class:"添加按钮"},{default:n(()=>[m("添加")]),_:1})]),I("div",ae,[l(H,{data:S(j),stripe:"",class:"table",height:"640","row-style":{height:"50px"}},{default:n(()=>[l(_,{fixed:"",prop:"number",label:"工号",width:"140"},{default:n(t=>[t.row.isAdd?(i(),p(c,{key:0,modelValue:t.row.number,"onUpdate:modelValue":o=>t.row.number=o,type:"text",placeholder:"工号"},null,8,["modelValue","onUpdate:modelValue"])):(i(),b("span",le,f(t.row.number),1))]),_:1}),l(_,{prop:"name",label:"姓名",width:"150"},{default:n(t=>[t.row.isAdd?(i(),p(c,{key:0,modelValue:t.row.name,"onUpdate:modelValue":o=>t.row.name=o,type:"text",placeholder:"姓名"},null,8,["modelValue","onUpdate:modelValue"])):(i(),b("span",ne,f(t.row.name),1))]),_:1}),l(_,{prop:"sex",label:"性别",width:"140"},{default:n(t=>[t.row.isAdd?(i(),p(M,{key:0,modelValue:t.row.sex,"onUpdate:modelValue":o=>t.row.sex=o,class:"m-2",placeholder:"选择性别"},{default:n(()=>[l(V,{label:"男",value:"0"}),l(V,{label:"女",value:"1"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):(i(),p(E,{key:1,type:t.row.sex===0?"warning":"","disable-transitions":"",effect:"light",round:"",class:"bigger"},{default:n(()=>[m(f(A(t.row.sex)),1)]),_:2},1032,["type"]))]),_:1}),l(_,{prop:"type",label:"职务",width:"120",filters:[{text:"厨师",value:2},{text:"服务员",value:1}],"filter-method":q,"filter-placement":"bottom-end"},{default:n(t=>[t.row.isEdit?w("",!0):(i(),p(E,{key:0,type:t.row.type===2?"success":"error","disable-transitions":"",class:"bigger"},{default:n(()=>[m(f(T(t.row.type)),1)]),_:2},1032,["type"])),t.row.isEdit?(i(),p(M,{key:1,modelValue:t.row.type,"onUpdate:modelValue":o=>t.row.type=o,class:"m-2",placeholder:"选择工种"},{default:n(()=>[l(V,{label:"服务员",value:"1"}),l(V,{label:"厨师",value:"2"})]),_:2},1032,["modelValue","onUpdate:modelValue"])):w("",!0)]),_:1}),l(_,{prop:"phonenumber",label:"联系方式",width:"200"},{default:n(t=>[t.row.isEdit?(i(),p(c,{key:0,modelValue:t.row.phonenumber,"onUpdate:modelValue":o=>t.row.phonenumber=o,type:"text",maxlength:"11",placeholder:"联系方式",onInput:o=>R(t.row),class:"输入电话"},null,8,["modelValue","onUpdate:modelValue","onInput"])):(i(),b("span",se,f(t.row.phonenumber),1)),S(x)=="正确"&&t.row.id==""?(i(),p(E,{key:2},{default:n(()=>[m("正确")]),_:1})):w("",!0),S(x)=="错误"&&t.row.id==""?(i(),p(E,{key:3},{default:n(()=>[m("错误")]),_:1})):w("",!0)]),_:1}),l(_,{prop:"registertime",label:"入职时间",width:"180"},{default:n(t=>[I("span",ie,f(t.row.registertime),1)]),_:1}),l(_,{prop:"password",label:"密码",width:"220"},{default:n(t=>[t.row.isEdit?(i(),p(c,{key:0,modelValue:t.row.password,"onUpdate:modelValue":o=>t.row.password=o,type:"text",placeholder:"密码"},null,8,["modelValue","onUpdate:modelValue"])):(i(),b("span",oe,f(t.row.password),1))]),_:1}),l(_,{fixed:"right",label:"操作",width:"150"},{default:n(t=>[t.row.isEdit?(i(),b("div",de,[l(d,{link:"",type:"primary",size:"small",onClick:o=>F(t.row)},{default:n(()=>[m("确定")]),_:2},1032,["onClick"]),l(d,{link:"",type:"danger",size:"small",onClick:o=>G(t.row)},{default:n(()=>[m("取消")]),_:2},1032,["onClick"])])):(i(),b("div",ue,[l(d,{link:"",type:"primary",size:"small",onClick:o=>B(t.row)},{default:n(()=>[m(" 编辑")]),_:2},1032,["onClick"]),l(d,{link:"",type:"danger",size:"small",onClick:o=>N(t.$index,t.row)},{default:n(()=>[m("删除")]),_:2},1032,["onClick"])]))]),_:1})]),_:1},8,["data"]),l(J,{onCurrentChange:P,"current-page":v.value,"page-size":g.value,total:S(k),layout:"->,total, prev, pager, next",class:"pagination-container"},null,8,["current-page","page-size","total"])])],64)}}});const he=X(re,[["__scopeId","data-v-49cfa296"]]);export{he as default};
