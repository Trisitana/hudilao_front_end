import{k,l as ve,m as _e,n as ye,o as ge,p as he,q as be}from"./adminapi-369833a9.js";import{d as Ve,r,j as N,c as S,B as ke,a as f,o as s,b as v,g as U,e as l,w as d,f as p,n as we,D as b,C as w,m as j,F as Ce,E as x,I as m,k as C,h as Ue,_ as xe}from"./index-077565e4.js";import"./manage-1ae7ae30.js";const Se=["src"],Te={class:"dialog-footer"},ze={class:"表格"},Ie={key:1},Pe={key:1},De={key:1},Ee={key:1},Re={key:1},Fe={key:0},Ne={key:1,class:"flex"},$e={key:0},Me={key:1},Ae=["src"],Be=Ve({__name:"DishManage",setup(Le){const T=r(1),z=r(13),n=N({inputSearch:"",select:"",dialogVisible:!1}),u=N({foodName:"",foodType:"",foodRepo:"",foodPrice:""}),V=N({foodid:-1,name:"",foodtype:0,repository:0,price:0,monthsale:0,img:"",top:0,inuse:0}),H=()=>{n.dialogVisible=!0},q=()=>{n.dialogVisible=!1},G=()=>{u.foodName&&parseInt(u.foodPrice)>0&&u.foodRepo&&u.foodType?ve({name:u.foodName,foodtype:u.foodType,repository:u.foodRepo,price:u.foodPrice,img:P.value}).then(a=>{k().then(o=>{_.value=o.data.data}),x({title:"通知",message:"菜品添加成功",type:"success"}),n.dialogVisible=!1}):x({title:"通知",message:"请正确添加菜品信息",type:"error"})},W=a=>{m(a,"isEdit",!0),V.foodid=a.foodid,V.repository=a.repository,V.price=a.price},J=a=>{_e({foodid:a.foodid}).then(o=>{k().then(t=>{_.value=t.data.data}),C({type:"info",message:"下架成功"})})},K=a=>{ye({foodid:a.foodid}).then(o=>{k().then(t=>{_.value=t.data.data}),C({type:"success",message:"上架成功"})})},O=a=>{m(a,"foodid",a.foodid),m(a,"repository",a.repository),m(a,"price",a.price),m(a,"isEdit",!1),m(a,"isAdd",!1),ge({foodid:a.foodid,repository:a.repository,price:a.price}).then(o=>{console.log(o.data),C({type:"success",message:"编辑成功！"})})},Q=a=>{m(a,"foodid",V.foodid),m(a,"repository",V.repository),m(a,"price",V.price),m(a,"isEdit",!1),m(a,"isAdd",!1),C({type:"info",message:"取消编辑！"})},X=a=>{he({foodid:a.foodid}).then(o=>{k().then(t=>{_.value=t.data.data}),C({type:"info",message:"已取消置顶"})})},Y=a=>{be({foodid:a.foodid}).then(o=>{k().then(t=>{_.value=t.data.data}),C({type:"success",message:"已置顶"})})},Z=a=>{T.value=a};let ee=S(()=>_.value.filter(o=>{if(n.inputSearch===""&&n.select==="")return!0;if(n.inputSearch!=""&&n.select===""&&o.name.includes(n.inputSearch))return o.name.includes(n.inputSearch);if(n.inputSearch===""&&n.select!="")return o.foodtype.toString()==n.select;if(n.inputSearch!=""&&n.select!="")return n.select="",o.name.includes(n.inputSearch)})),le=S(()=>ee.value.length),$=S(()=>{const a=(T.value-1)*z.value,o=a+z.value;return _.value.filter(h=>{if(n.inputSearch===""&&n.select==="")return!0;if(n.inputSearch!=""&&n.select===""&&h.name.includes(n.inputSearch))return h.name.includes(n.inputSearch);if(n.inputSearch===""&&n.select!="")return h.foodtype.toString()==n.select;if(n.inputSearch!=""&&n.select!="")return n.select="",h.name.includes(n.inputSearch)}).slice(a,o)});const M=r("");var A=new Image;const B=r(""),I=r(!1);function ae(a,o){A.src=a.img,setTimeout(function(){M.value=A.width+40+"px",B.value=a.img,I.value=!0},1e3)}let _=r([]);ke(()=>{k().then(a=>{console.log(a.data.data),_.value=a.data.data,console.log(_.value),console.log($)})});function oe(a){return["锅底","特色菜","牛羊肉","海鲜","丸滑","其他荤菜","豆面制品","菌菇","蔬菜","饮料酒水","甜品","主食","自选类"][a-1]}r("");const P=r(""),te=r(!1),D=r(),E=r([]);function ne(a){x({message:"图片上传成功",type:"success",duration:1500}),console.log(a),te.value=!0,P.value=a.data,console.log(P.value)}function de(a){if(!(a.size/1024/1024<1))return x({message:"图片大小不能超过1MB",type:"error",duration:1500}),!1}function ie(){x({message:"图片上传失败",type:"error",duration:1500}),console.log("error")}const se=a=>{D.value.clearFiles();const o=a[0];o.uid=Ue(),D.value.handleStart(o)},ue=S(()=>E.value.length>0),L=r(""),R=r(!1),re=a=>{L.value=a.url,R.value=!0};return(a,o)=>{const t=f("el-option"),h=f("el-select"),g=f("el-input"),c=f("el-button"),pe=f("el-upload"),F=f("el-dialog"),y=f("el-table-column"),ce=f("el-input-number"),me=f("el-table"),fe=f("el-pagination");return s(),v(Ce,null,[U("div",null,[l(g,{modelValue:n.inputSearch,"onUpdate:modelValue":o[1]||(o[1]=e=>n.inputSearch=e),placeholder:"搜索菜品名称",class:"inputSearch",clearable:""},{prepend:d(()=>[l(h,{modelValue:n.select,"onUpdate:modelValue":o[0]||(o[0]=e=>n.select=e),placeholder:"筛选菜品",style:{width:"105px"}},{default:d(()=>[l(t,{label:"全部菜品",value:""}),l(t,{label:"锅底",value:"1"}),l(t,{label:"特色菜",value:"2"}),l(t,{label:"牛羊肉",value:"3"}),l(t,{label:"海鲜",value:"4"}),l(t,{label:"丸滑",value:"5"}),l(t,{label:"其他荤菜",value:"6"}),l(t,{label:"豆面制品",value:"7"}),l(t,{label:"菌菇",value:"8"}),l(t,{label:"蔬菜",value:"9"}),l(t,{label:"饮料酒水",value:"10"}),l(t,{label:"甜品",value:"11"}),l(t,{label:"主食",value:"12"}),l(t,{label:"自选类",value:"13"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),l(c,{round:"",type:"primary",onClick:H,class:"添加按钮"},{default:d(()=>[p("添加菜品")]),_:1})]),l(F,{title:"添加菜品",modelValue:n.dialogVisible,"onUpdate:modelValue":o[10]||(o[10]=e=>n.dialogVisible=e),"close-on-click-modal":!1,"show-close":!1,center:"",width:"30%"},{footer:d(()=>[U("span",Te,[l(c,{onClick:o[8]||(o[8]=e=>q())},{default:d(()=>[p("取消")]),_:1}),l(c,{type:"primary",onClick:o[9]||(o[9]=e=>G())},{default:d(()=>[p(" 添加 ")]),_:1})])]),default:d(()=>[l(g,{modelValue:u.foodName,"onUpdate:modelValue":o[3]||(o[3]=e=>u.foodName=e),placeholder:"菜品名称",class:"菜品类别及名称"},{prepend:d(()=>[l(h,{modelValue:u.foodType,"onUpdate:modelValue":o[2]||(o[2]=e=>u.foodType=e),placeholder:"菜品类别",style:{width:"100px"}},{default:d(()=>[l(t,{label:"锅底",value:"1"}),l(t,{label:"特色菜",value:"2"}),l(t,{label:"牛羊肉",value:"3"}),l(t,{label:"海鲜",value:"4"}),l(t,{label:"丸滑",value:"5"}),l(t,{label:"其他荤菜",value:"6"}),l(t,{label:"豆面制品",value:"7"}),l(t,{label:"菌菇",value:"8"}),l(t,{label:"蔬菜",value:"9"}),l(t,{label:"饮料酒水",value:"10"}),l(t,{label:"甜品",value:"11"}),l(t,{label:"主食",value:"12"}),l(t,{label:"自选类",value:"13"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),l(g,{modelValue:u.foodRepo,"onUpdate:modelValue":o[4]||(o[4]=e=>u.foodRepo=e),placeholder:"请输入库存",class:"库存输入框"},null,8,["modelValue"]),l(g,{modelValue:u.foodPrice,"onUpdate:modelValue":o[5]||(o[5]=e=>u.foodPrice=e),placeholder:"请输入单价",class:"单价输入框"},null,8,["modelValue"]),l(pe,{ref_key:"upload",ref:D,action:"http://192.168.121.155:8082/images/upload",limit:1,"list-type":"picture-card",accept:".png, .jpg,.webp","file-list":E.value,"onUpdate:fileList":o[6]||(o[6]=e=>E.value=e),"on-success":ne,"on-error":ie,"on-exceed":se,"before-upload":de,class:we([{disabled:ue.value},"上传图片"]),"on-preview":re},{default:d(()=>[l(c,{size:"small",type:"primary"},{default:d(()=>[p(" 点击上传 ")]),_:1})]),_:1},8,["file-list","class"]),l(F,{modelValue:R.value,"onUpdate:modelValue":o[7]||(o[7]=e=>R.value=e)},{default:d(()=>[U("img",{"w-full":"",src:L.value,alt:"Preview Image"},null,8,Se)]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),U("div",ze,[l(me,{data:j($),stripe:"",class:"table",height:"590"},{default:d(()=>[l(y,{fixed:"",prop:"foodid",label:"菜品id",width:"100"},{default:d(e=>[e.row.isAdd?(s(),b(g,{key:0,modelValue:e.row.foodid,"onUpdate:modelValue":i=>e.row.foodid=i,type:"text",placeholder:"菜品id"},null,8,["modelValue","onUpdate:modelValue"])):(s(),v("span",Ie,w(e.row.foodid),1))]),_:1}),l(y,{prop:"name",label:"菜名",width:"180"},{default:d(e=>[e.row.isAdd?(s(),b(g,{key:0,modelValue:e.row.name,"onUpdate:modelValue":i=>e.row.name=i,type:"text",placeholder:"菜名"},null,8,["modelValue","onUpdate:modelValue"])):(s(),v("span",Pe,w(e.row.name),1))]),_:1}),l(y,{prop:"foodtype",label:"类别",width:"150"},{default:d(e=>[p(w(oe(e.row.foodtype)),1)]),_:1}),l(y,{prop:"repository",label:"库存",width:"180"},{default:d(e=>[e.row.isEdit?(s(),b(ce,{key:0,modelValue:e.row.repository,"onUpdate:modelValue":i=>e.row.repository=i,min:0,"controls-position":"right",placeholder:"库存"},null,8,["modelValue","onUpdate:modelValue"])):(s(),v("span",De,w(e.row.repository)+" 份",1))]),_:1}),l(y,{prop:"price",label:"单价",width:"150"},{default:d(e=>[e.row.isEdit?(s(),b(g,{key:0,modelValue:e.row.price,"onUpdate:modelValue":i=>e.row.price=i,type:"text",placeholder:"单价"},null,8,["modelValue","onUpdate:modelValue"])):(s(),v("span",Ee,w(e.row.price)+" 元/份",1))]),_:1}),l(y,{prop:"monthsale",label:"月售",width:"150"},{default:d(e=>[e.row.isAdd?(s(),b(g,{key:0,modelValue:e.row.monthsale,"onUpdate:modelValue":i=>e.row.monthsale=i,type:"text",placeholder:"月售"},null,8,["modelValue","onUpdate:modelValue"])):(s(),v("span",Re,w(e.row.monthsale)+" 份",1))]),_:1}),l(y,{fix:"right",label:"操作",width:"170"},{default:d(e=>[e.row.isEdit?(s(),v("div",Fe,[l(c,{link:"",type:"primary",size:"small",onClick:i=>O(e.row)},{default:d(()=>[p("确定")]),_:2},1032,["onClick"]),l(c,{link:"",type:"danger",size:"small",onClick:i=>Q(e.row)},{default:d(()=>[p("取消")]),_:2},1032,["onClick"])])):(s(),v("div",Ne,[l(c,{link:"",type:"primary",size:"small",onClick:i=>W(e.row)},{default:d(()=>[p(" 编辑")]),_:2},1032,["onClick"]),e.row.inuse==0?(s(),b(c,{key:0,link:"",type:"danger",size:"small",onClick:i=>J(e.row)},{default:d(()=>[p("下架")]),_:2},1032,["onClick"])):(s(),b(c,{key:1,link:"",type:"danger",size:"small",onClick:i=>K(e.row)},{default:d(()=>[p("上架")]),_:2},1032,["onClick"]))]))]),_:1}),l(y,{fix:"right",prop:"pinTop",label:"置顶"},{default:d(e=>[e.row.top?(s(),v("div",$e,[l(c,{round:"",bg:"",type:"primary",size:"small",onClick:i=>X(e.row)},{default:d(()=>[p("取消置顶")]),_:2},1032,["onClick"])])):(s(),v("div",Me,[l(c,{round:"",bg:"",type:"",size:"small",onClick:i=>Y(e.row)},{default:d(()=>[p(" 置顶")]),_:2},1032,["onClick"])]))]),_:1}),l(y,{fixed:"right",label:"查看图片",width:"140"},{default:d(e=>[l(c,{link:"",type:"primary",size:"small",onClick:i=>ae(e.row,e.column)},{default:d(()=>[p("查看图片")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),l(fe,{onCurrentChange:Z,"current-page":T.value,"page-size":z.value,total:j(le),layout:"->, total, prev, pager, next",class:"pagination-container"},null,8,["current-page","page-size","total"])]),l(F,{modelValue:I.value,"onUpdate:modelValue":o[11]||(o[11]=e=>I.value=e),width:M.value},{default:d(()=>[U("img",{"w-full":"",src:B.value,alt:"Preview Image"},null,8,Ae)]),_:1},8,["modelValue","width"])],64)}}});const Ge=xe(Be,[["__scopeId","data-v-7ecd7664"]]);export{Ge as default};
