import{_ as E,u as R,i as S,r as v,c as b,B as U,a as i,o as G,b as H,e as a,w as o,m as A,g as _,C as p,f as x,k as L}from"./index-077565e4.js";import{x as k,y as P}from"./adminapi-369833a9.js";import"./manage-1ae7ae30.js";const $={class:"main-form"},j={class:"block"},q={m:"4",class:"content"},J={m:"t-0 b-2",class:"font-detail"},K={m:"t-0 b-2",class:"font-detail"},O={m:"t-0 b-2"},Q={m:"t-0 b-2"},W={class:"加粗 biggger"},X={class:"bigger"},Z={__name:"ViewAnnouncement",setup(ee){R(),S();const h=v(1),w=v(11);let f=v([]);function M(t){h.value=t}let V=b(()=>D.value.length),D=b(()=>f.value.filter(n=>{if(c.value==="")return s.value===""?!0:n.title.includes(s.value);{const l=new Date(n.time).getMonth()+1,r=c.value.getMonth()+1,d=new Date(n.time).getFullYear(),m=c.value.getFullYear();return console.log(d),console.log(m),s.value===""?l===r&&d===m:l===r&&d===m&&n.title.includes(s.value)}})),C=b(()=>{const t=(h.value-1)*w.value,n=t+w.value;return f.value.filter(r=>{if(c.value==="")return s.value===""?!0:r.title.includes(s.value);{const d=new Date(r.time).getMonth()+1,m=c.value.getMonth()+1,u=new Date(r.time).getFullYear(),g=c.value.getFullYear();return s.value===""?d===m&&u===g:d===m&&u===g&&r.title.includes(s.value)}}).slice(t,n)});function Y(t,n){const l=t.emergency;if(l==0)return"常规";if(l==1)return"紧急"}function y(t,n){const l=t.type;if(l==1)return"服务员";if(l==2)return"厨师";if(l==3)return"群发"}function F(t,n){const l=t.type;if(l==1)return"success";if(l==2)return"warning";if(l==3)return"danger"}const c=v(""),s=v("");function z(t){P({announcementid:t.announcementid}).then(n=>{k().then(l=>{f.value=l.data.data}),L({type:"success",message:"已删除"})})}const B=(t,n)=>n.type==t;return U(()=>{k().then(t=>{f.value=t.data.data,console.log(f.value)})}),(t,n)=>{const l=i("el-input"),r=i("el-form-item"),d=i("el-date-picker"),m=i("el-form"),u=i("el-table-column"),g=i("el-tag"),T=i("el-button"),I=i("el-table"),N=i("el-pagination");return G(),H("div",$,[a(m,{class:"date-picker"},{default:o(()=>[a(r,{label:"查询标题"},{default:o(()=>[a(l,{placeholder:"请输入标题查询",modelValue:s.value,"onUpdate:modelValue":n[0]||(n[0]=e=>s.value=e)},null,8,["modelValue"])]),_:1}),a(r,{label:"选择月份",class:"month-pick-form"},{default:o(()=>[_("div",j,[a(d,{modelValue:c.value,"onUpdate:modelValue":n[1]||(n[1]=e=>c.value=e),type:"month",placeholder:"选择查询月份",clearable:""},null,8,["modelValue"])])]),_:1})]),_:1}),a(I,{data:A(C),stripe:"",class:"table",height:"590","row-style":{height:"50px"}},{default:o(()=>[a(u,{type:"expand"},{default:o(e=>[_("div",q,[_("p",J,"标题: "+p(e.row.title),1),_("p",K,"内容: "+p(e.row.content),1),_("p",O,"发送时间: "+p(e.row.time),1),_("p",Q,"发送对象: "+p(y(e.row,e.column)),1)])]),_:1}),a(u,{prop:"title",label:"公告标题",width:"640",class:"加粗"},{default:o(e=>[_("div",W,p(e.row.title),1)]),_:1}),a(u,{prop:"emergency",label:"公告类型",width:"140"},{default:o(e=>[a(g,{type:e.row.emergency===1?"danger":"","disable-transitions":"",effect:"light",round:"",class:"biger"},{default:o(()=>[x(p(Y(e.row,e.column)),1)]),_:2},1032,["type"])]),_:1}),a(u,{prop:"time",label:"发送日期",width:"129"},{default:o(e=>[_("div",X,p(new Date(e.row.time).getFullYear()+"/"+(new Date(e.row.time).getMonth()+1)+"/"+new Date(e.row.time).getDate()),1)]),_:1}),a(u,{prop:"type",label:"发送对象",width:"140",formatter:y,filters:[{text:"服务员",value:1},{text:"后厨",value:2},{text:"群发",value:3}],"filter-method":B,class:"biger"},{default:o(e=>[a(g,{type:F(e.row,e.column),"disable-transitions":""},{default:o(()=>[x(p(y(e.row,e.column)),1)]),_:2},1032,["type"])]),_:1}),a(u,{fixed:"right",label:"操作",width:"120"},{default:o(e=>[a(T,{link:"",type:"primary",size:"small",onClick:te=>z(e.row)},{default:o(()=>[x("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),a(N,{onCurrentChange:M,"current-page":h.value,"page-size":w.value,total:A(V),layout:"->,total, prev, pager, next",class:"pagination-container",background:""},null,8,["current-page","page-size","total"])])}}},oe=E(Z,[["__scopeId","data-v-85985c2d"]]);export{oe as default};
